# An√°lise de Viabilidade: Sistema de Regras de Neg√≥cio tipo Kanban para VibeCForms

**Evolu√ß√£o do Sistema de Gerenciamento de Formul√°rios Din√¢micos**

**Data:** 20/10/2025
**Vers√£o:** 1.0
**Status:** üü¢ APROVADO PARA IMPLEMENTA√á√ÉO

---

## √çndice

1. [Resumo Executivo](#1-resumo-executivo)
2. [An√°lise Arquitetural](#2-an√°lise-arquitetural)
   - 2.1. [Compatibilidade com Arquitetura Atual](#21-compatibilidade-com-arquitetura-atual)
   - 2.2. [Nova Arquitetura Proposta](#22-nova-arquitetura-proposta)
3. [Design da Solu√ß√£o](#3-design-da-solu√ß√£o)
   - 3.1. [Modelo de Dados](#31-modelo-de-dados)
   - 3.2. [Tipos de Controle](#32-tipos-de-controle)
4. [Plano de Implementa√ß√£o](#4-plano-de-implementa√ß√£o)
   - 4.1. [Fase 1: Foundation (Semanas 1-2) - MVP](#fase-1-foundation-semanas-1-2---mvp)
   - 4.2. [Fase 2: Kanban UI (Semanas 3-4)](#fase-2-kanban-ui-semanas-3-4)
   - 4.3. [Fase 3: Rules Engine (Semanas 5-6)](#fase-3-rules-engine-semanas-5-6)
   - 4.4. [Fase 4: Integration & Polish (Semanas 7-8)](#fase-4-integration--polish-semanas-7-8)
   - 4.5. [Fase 5: AI Integration (Semanas 9-12) - OPCIONAL](#fase-5-ai-integration-semanas-9-12---opcional)
5. [Estimativa de Esfor√ßo](#5-estimativa-de-esfor√ßo)
6. [Riscos e Mitiga√ß√£o](#6-riscos-e-mitiga√ß√£o)
7. [Compatibilidade e Backward Compatibility](#7-compatibilidade-e-backward-compatibility)
8. [Benef√≠cios](#8-benef√≠cios)
9. [Recomenda√ß√£o Final](#9-recomenda√ß√£o-final)
10. [Tecnologias Recomendadas](#10-tecnologias-recomendadas)

---

## 1. Resumo Executivo

A proposta de criar um **Sistema de Regras de Neg√≥cio tipo Kanban** para conectar os formul√°rios do VibeCForms √© **ALTAMENTE VI√ÅVEL** e representa uma evolu√ß√£o natural do projeto. O sistema atual j√° possui uma arquitetura s√≥lida (v3.0 - Persistence System) que facilita essa expans√£o.

### Pontos-chave da An√°lise

| Status | Descri√ß√£o |
|--------|-----------|
| ‚úÖ | Arquitetura atual suporta a expans√£o proposta |
| ‚úÖ | Sistema de persist√™ncia plug√°vel facilita armazenamento de workflows |
| ‚úÖ | JSON-based specs permitem definir regras de forma declarativa |
| ‚úÖ | Backend SQLite/MySQL/PostgreSQL j√° implementados/planejados suportam rela√ß√µes complexas |
| ‚ö†Ô∏è | Requer novo m√≥dulo de workflow engine |
| ‚ö†Ô∏è | Interface de Kanban necessita desenvolvimento frontend |

### Exemplo de Uso Proposto

**Fluxo de Pedidos:**

```
Or√ßamento ‚Üí Em Prepara√ß√£o ‚Üí Aguardando Pagamento ‚Üí Entrega ‚Üí Conclu√≠do
     ‚Üì              ‚Üì                   ‚Üì               ‚Üì
Pr√©-requisitos  Pr√©-requisitos    Pr√©-requisitos   Pr√©-requisitos
```

1. **Or√ßamento**: Confirma√ß√£o do Cliente + Checagem de estoque
2. **Em Prepara√ß√£o**: Confirma pagamento + Confirma entrega + Confirma dados do cliente
3. **Aguardando Pagamento**: Pago ou Pago na entrega
4. **Entrega**: Pago + Entregue
5. **Conclu√≠do**: Processo finalizado

---

## 2. An√°lise Arquitetural

### 2.1. Compatibilidade com Arquitetura Atual

O VibeCForms v3.0 apresenta uma arquitetura robusta baseada em padr√µes de design consolidados (Repository, Adapter e Factory Patterns). Esta base fornece pontos de for√ßa significativos para a implementa√ß√£o do sistema de workflows.

#### Pontos Fortes (Strengths)

- **Repository Pattern existente**: Facilita CRUD de workflows e transi√ß√µes
- **Multi-backend support**: Workflows podem ser armazenados em SQLite, MySQL ou PostgreSQL
- **JSON-based configuration**: Alinha-se perfeitamente com a abordagem de specs JSON
- **Schema change detection**: Sistema j√° detecta mudan√ßas - √∫til para evolu√ß√£o de workflows
- **Migration system**: Permite migrar workflows entre backends

#### Lacunas Identificadas (Gaps)

- N√£o existe m√≥dulo de workflow/state machine
- Falta sistema de eventos/triggers
- Aus√™ncia de hist√≥rico de transi√ß√µes (audit log)
- Interface UI limitada (apenas formul√°rios, sem Kanban board)

### 2.2. Nova Arquitetura Proposta

A arquitetura proposta mant√©m todos os m√≥dulos existentes e adiciona novas camadas especializadas:

```
VibeCForms v4.0 - Business Rules Engine
‚îÇ
‚îú‚îÄ‚îÄ Existing Modules (mantidos)
‚îÇ   ‚îú‚îÄ‚îÄ Form Generation (JSON specs)
‚îÇ   ‚îú‚îÄ‚îÄ Persistence Layer (multi-backend)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BaseRepository (interface)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TxtAdapter (implementado)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SQLiteAdapter (implementado)
‚îÇ   ‚îî‚îÄ‚îÄ Template System (Jinja2)
‚îÇ
‚îú‚îÄ‚îÄ NEW: Workflow Engine
‚îÇ   ‚îú‚îÄ‚îÄ workflow_manager.py       # Gerencia workflows e transi√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ state_machine.py          # State machine para cada processo
‚îÇ   ‚îú‚îÄ‚îÄ rules_engine.py           # Avalia pr√©-requisitos
‚îÇ   ‚îú‚îÄ‚îÄ transition_validator.py   # Valida transi√ß√µes entre estados
‚îÇ   ‚îî‚îÄ‚îÄ event_logger.py           # Registra hist√≥rico de transi√ß√µes
‚îÇ
‚îú‚îÄ‚îÄ NEW: Workflow Specs (JSON-based)
‚îÇ   ‚îú‚îÄ‚îÄ workflows/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pedidos_workflow.json  # Define fluxo de pedidos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vendas_workflow.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _workflow.json (schema)
‚îÇ   ‚îî‚îÄ‚îÄ rules/
‚îÇ       ‚îú‚îÄ‚îÄ prerequisite_rules.json # Regras de pr√©-requisitos
‚îÇ       ‚îî‚îÄ‚îÄ transition_rules.json   # Regras de transi√ß√£o
‚îÇ
‚îî‚îÄ‚îÄ NEW: Kanban UI
    ‚îú‚îÄ‚îÄ templates/kanban/
    ‚îÇ   ‚îú‚îÄ‚îÄ board.html              # Kanban board view
    ‚îÇ   ‚îú‚îÄ‚îÄ card.html               # Card de processo
    ‚îÇ   ‚îî‚îÄ‚îÄ column.html             # Coluna de status
    ‚îî‚îÄ‚îÄ static/js/
        ‚îú‚îÄ‚îÄ kanban.js               # Drag & drop
        ‚îî‚îÄ‚îÄ workflow_actions.js     # A√ß√µes de workflow
```

---

## 3. Design da Solu√ß√£o

### 3.1. Modelo de Dados

O sistema de workflows utiliza dois componentes principais:

#### A) Workflow Specification (JSON)

Define a estrutura do workflow, estados, pr√©-requisitos e transi√ß√µes.

```json
{
  "workflow_name": "pedidos",
  "title": "Fluxo de Pedidos",
  "form_ref": "pedidos",
  "states": [
    {
      "id": "orcamento",
      "name": "Or√ßamento",
      "order": 1,
      "color": "#FFC107",
      "icon": "fa-calculator",
      "prerequisites": [
        {
          "type": "user_action",
          "action": "confirmacao_cliente",
          "label": "Confirma√ß√£o do Cliente",
          "required": true
        },
        {
          "type": "system_check",
          "check": "estoque_disponivel",
          "label": "Checagem de Estoque",
          "script": "scripts/check_estoque.py",
          "required": true
        }
      ],
      "next_states": ["em_preparacao", "cancelado"]
    },
    {
      "id": "em_preparacao",
      "name": "Em Prepara√ß√£o",
      "order": 2,
      "color": "#2196F3",
      "prerequisites": [
        {
          "type": "field_check",
          "field": "forma_pagamento",
          "condition": "not_empty",
          "label": "Confirma Forma de Pagamento"
        },
        {
          "type": "field_check",
          "field": "forma_entrega",
          "condition": "in",
          "values": ["frete", "em_maos"],
          "label": "Confirma Forma de Entrega"
        },
        {
          "type": "field_check",
          "field": "dados_cliente_completos",
          "condition": "equals",
          "value": true,
          "label": "Confirma Dados do Cliente"
        }
      ],
      "next_states": ["aguardando_pagamento", "cancelado"]
    },
    {
      "id": "aguardando_pagamento",
      "name": "Aguardando Pagamento",
      "order": 3,
      "color": "#FF5722",
      "prerequisites": [
        {
          "type": "field_check",
          "field": "status_pagamento",
          "condition": "in",
          "values": ["pago", "pago_na_entrega"],
          "label": "Pagamento Confirmado"
        }
      ],
      "next_states": ["entrega", "cancelado"]
    },
    {
      "id": "entrega",
      "name": "Entrega",
      "order": 4,
      "color": "#9C27B0",
      "prerequisites": [
        {
          "type": "field_check",
          "field": "entregue",
          "condition": "equals",
          "value": true,
          "label": "Entregue"
        }
      ],
      "next_states": ["concluido"]
    },
    {
      "id": "concluido",
      "name": "Conclu√≠do",
      "order": 5,
      "color": "#4CAF50",
      "is_final": true
    },
    {
      "id": "cancelado",
      "name": "Cancelado",
      "color": "#F44336",
      "is_final": true,
      "can_transition_from_any": true
    }
  ],
  "notifications": {
    "email_on_state_change": true,
    "webhook_url": "https://api.example.com/webhooks/pedidos"
  },
  "automation": {
    "auto_transition_on_prerequisites": true,
    "ai_agent_check_interval_minutes": 60,
    "ai_agent_enabled": false
  }
}
```

#### B) Database Schema

Tabelas para armazenar inst√¢ncias de processos e hist√≥rico.

```sql
-- Tabela principal de processos
CREATE TABLE workflow_processes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    workflow_name VARCHAR(100) NOT NULL,
    form_name VARCHAR(100) NOT NULL,
    record_id INTEGER NOT NULL,  -- ID do registro no formul√°rio
    current_state VARCHAR(50) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_by VARCHAR(100),
    assigned_to VARCHAR(100),
    metadata JSON,  -- Campos adicionais flex√≠veis
    FOREIGN KEY (workflow_name) REFERENCES workflows(name)
);

-- Hist√≥rico de transi√ß√µes (audit log)
CREATE TABLE workflow_transitions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    process_id INTEGER NOT NULL,
    from_state VARCHAR(50),
    to_state VARCHAR(50) NOT NULL,
    transition_type VARCHAR(20),  -- manual, automatic, ai_agent
    transition_by VARCHAR(100),  -- usu√°rio ou 'system'
    transition_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    prerequisites_met JSON,  -- Quais pr√©-requisitos foram cumpridos
    notes TEXT,
    FOREIGN KEY (process_id) REFERENCES workflow_processes(id)
);

-- Rastreamento de pr√©-requisitos
CREATE TABLE workflow_prerequisites (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    process_id INTEGER NOT NULL,
    prerequisite_id VARCHAR(100) NOT NULL,
    status VARCHAR(20),  -- pending, met, failed
    checked_at TIMESTAMP,
    checked_by VARCHAR(100),
    check_result JSON,
    FOREIGN KEY (process_id) REFERENCES workflow_processes(id)
);

-- √çndices para performance
CREATE INDEX idx_processes_workflow ON workflow_processes(workflow_name);
CREATE INDEX idx_processes_state ON workflow_processes(current_state);
CREATE INDEX idx_transitions_process ON workflow_transitions(process_id);
CREATE INDEX idx_prerequisites_process ON workflow_prerequisites(process_id);
```

### 3.2. Tipos de Controle

O sistema suporta tr√™s formas de controle de fluxo, conforme especificado nos requisitos:

#### 1. Controle Manual (Usu√°rio Humano)

- **Interface Kanban** com drag & drop para mover processos entre colunas
- **Bot√µes de a√ß√£o** para transi√ß√£o manual com confirma√ß√£o
- **Checkboxes** para marcar pr√©-requisitos cumpridos
- **Modal de confirma√ß√£o** antes de transitar estados
- **Notas e coment√°rios** em transi√ß√µes

**Exemplo de Interface:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Or√ßamento  ‚îÇ Em Prepara√ß√£o‚îÇ Aguardando  ‚îÇ   Entrega   ‚îÇ  Conclu√≠do  ‚îÇ
‚îÇ             ‚îÇ              ‚îÇ  Pagamento  ‚îÇ             ‚îÇ             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [Card #123] ‚îÇ [Card #124] ‚îÇ [Card #125] ‚îÇ [Card #126] ‚îÇ [Card #127] ‚îÇ
‚îÇ [Card #128] ‚îÇ             ‚îÇ             ‚îÇ             ‚îÇ             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 2. Controle Sist√™mico (Checagem Autom√°tica)

Verifica√ß√£o autom√°tica de pr√©-requisitos com transi√ß√£o autom√°tica quando todos estiverem cumpridos.

**Exemplo de Implementa√ß√£o:**

```python
# src/workflow/rules_engine.py

class RulesEngine:
    def check_prerequisites(self, process_id, state):
        """Verifica se todos pr√©-requisitos foram cumpridos."""
        prerequisites = self.get_prerequisites(state)
        results = {}

        for prereq in prerequisites:
            if prereq['type'] == 'field_check':
                # Verifica condi√ß√£o em campo do formul√°rio
                results[prereq['id']] = self.check_field_condition(
                    process_id,
                    prereq['field'],
                    prereq['condition']
                )
            elif prereq['type'] == 'system_check':
                # Executa script Python customizado
                results[prereq['id']] = self.run_system_script(
                    prereq['script']
                )
            elif prereq['type'] == 'user_action':
                # Verifica se a√ß√£o foi marcada manualmente
                results[prereq['id']] = self.check_user_action(
                    process_id,
                    prereq['action']
                )

        return all(results.values()), results

    def auto_transition_if_ready(self, process_id):
        """Transiciona automaticamente se pr√©-requisitos cumpridos."""
        process = self.get_process(process_id)
        current_state = process['current_state']

        can_transition, prereqs = self.check_prerequisites(
            process_id, current_state
        )

        if can_transition and process['auto_transition_enabled']:
            next_state = self.get_next_state(current_state)
            self.transition(process_id, next_state, 'automatic')
            return True

        return False
```

**Exemplo de Script de Checagem:**

```python
# scripts/check_estoque.py

def check_estoque_disponivel(process_id):
    """Verifica se h√° estoque para os produtos do pedido."""
    process = get_process(process_id)
    form_data = get_form_data(process['record_id'])

    produtos = form_data['produtos']
    for produto in produtos:
        estoque = get_estoque(produto['id'])
        if estoque['quantidade'] < produto['quantidade']:
            return False, f"Estoque insuficiente para {produto['nome']}"

    return True, "Estoque dispon√≠vel para todos os produtos"
```

#### 3. Controle via IA (Futuro - Fase 5)

Agentes de IA para an√°lise inteligente de processos e sugest√µes autom√°ticas de a√ß√µes.

**Funcionalidades Planejadas:**
- An√°lise de completude de dados via LLM
- Sugest√µes de pr√≥ximas a√ß√µes baseadas em hist√≥rico
- Detec√ß√£o de anomalias (pre√ßos suspeitos, dados inconsistentes)
- Auto-completion inteligente de campos

**Exemplo de Implementa√ß√£o:**

```python
# src/workflow/ai_workflow_agent.py

class AIWorkflowAgent:
    def __init__(self, llm_client):
        self.llm = llm_client

    def analyze_process(self, process_id):
        """Analisa processo e sugere a√ß√µes."""
        context = self.gather_process_context(process_id)

        prompt = f"""
        Analisar processo de pedido #{process_id}:
        - Estado atual: {context['current_state']}
        - Dados: {context['form_data']}
        - Pr√©-requisitos: {context['prerequisites']}
        - Hist√≥rico: {context['history']}

        Avaliar se:
        1. Todos pr√©-requisitos foram cumpridos
        2. Existem bloqueios ou problemas
        3. Dados est√£o completos e consistentes
        4. Recomenda transi√ß√£o para pr√≥ximo estado

        Formato de resposta JSON:
        {{
            "prerequisites_met": true/false,
            "issues": ["lista de problemas identificados"],
            "recommendation": "pr√≥xima a√ß√£o sugerida",
            "confidence": 0.0-1.0
        }}
        """

        response = self.llm.complete(prompt)
        return json.loads(response)

    def detect_anomalies(self, process_id):
        """Detecta anomalias em dados do processo."""
        # IA analisa se h√° valores suspeitos
        pass

    def suggest_completion(self, process_id, field_name):
        """Sugere valor para campo baseado em contexto."""
        # IA sugere valor baseado em hist√≥rico
        pass
```

---

## 4. Plano de Implementa√ß√£o

A implementa√ß√£o est√° estruturada em 5 fases progressivas, onde cada fase entrega valor incremental.

### Fase 1: Foundation (Semanas 1-2) - MVP

**Objetivo:** Sistema b√°sico de workflow com transi√ß√µes manuais

**Entreg√°veis:**
1. ‚úÖ Schema de banco de dados (workflow_processes, workflow_transitions, workflow_prerequisites)
2. ‚úÖ Workflow specs JSON (`workflows/pedidos_workflow.json`)
3. ‚úÖ Workflow Manager b√°sico (CRUD de processos)
4. ‚úÖ State Machine simples
5. ‚úÖ API endpoints:
   - `POST /workflow/<workflow_name>/start` - Criar processo
   - `GET /workflow/process/<id>` - Ver processo
   - `POST /workflow/process/<id>/transition` - Transi√ß√£o manual
   - `GET /workflow/<workflow_name>/board` - Kanban board (dados JSON)

**Estrutura de Arquivos:**
```
src/
‚îú‚îÄ‚îÄ workflow/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ workflow_manager.py      # NEW
‚îÇ   ‚îú‚îÄ‚îÄ state_machine.py         # NEW
‚îÇ   ‚îî‚îÄ‚îÄ models.py                # NEW
‚îî‚îÄ‚îÄ specs/
    ‚îî‚îÄ‚îÄ workflows/
        ‚îú‚îÄ‚îÄ pedidos_workflow.json  # NEW
        ‚îî‚îÄ‚îÄ _workflow_schema.json  # NEW (documenta√ß√£o)
```

**Testes de Aceita√ß√£o:**
- [ ] Criar processo de pedido via API
- [ ] Transitar manualmente entre estados (Or√ßamento ‚Üí Em Prepara√ß√£o)
- [ ] Visualizar hist√≥rico completo de transi√ß√µes
- [ ] Validar que transi√ß√µes inv√°lidas s√£o bloqueadas
- [ ] 15+ testes unit√°rios passando

**Dura√ß√£o:** 2 semanas
**Recursos:** 1 desenvolvedor backend

---

### Fase 2: Kanban UI (Semanas 3-4)

**Objetivo:** Interface visual de Kanban

**Entreg√°veis:**
1. ‚úÖ Template `kanban/board.html` com colunas por estado
2. ‚úÖ Cards de processo arrast√°veis (drag & drop com SortableJS)
3. ‚úÖ Modal de detalhes do processo
4. ‚úÖ Checklist visual de pr√©-requisitos
5. ‚úÖ Bot√µes de a√ß√£o (aprovar, rejeitar, avan√ßar)
6. ‚úÖ Filtros (por usu√°rio, data, status)

**Stack T√©cnico:**
- **Frontend:** Vanilla JS ou Vue.js (lightweight)
- **Drag & Drop:** SortableJS (`https://github.com/SortableJS/Sortable`)
- **CSS:** Tailwind CSS ou Bootstrap 5
- **Icons:** FontAwesome (j√° usado no projeto)

**Estrutura de Arquivos:**
```
src/
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ kanban/
‚îÇ       ‚îú‚îÄ‚îÄ board.html           # NEW - Kanban board
‚îÇ       ‚îú‚îÄ‚îÄ card.html            # NEW - Card de processo
‚îÇ       ‚îú‚îÄ‚îÄ column.html          # NEW - Coluna de status
‚îÇ       ‚îî‚îÄ‚îÄ process_modal.html   # NEW - Modal de detalhes
‚îî‚îÄ‚îÄ static/
    ‚îú‚îÄ‚îÄ css/
    ‚îÇ   ‚îî‚îÄ‚îÄ kanban.css           # NEW
    ‚îî‚îÄ‚îÄ js/
        ‚îú‚îÄ‚îÄ kanban.js            # NEW - Drag & drop
        ‚îî‚îÄ‚îÄ workflow_actions.js  # NEW - A√ß√µes de workflow
```

**Exemplo de Interface:**
```html
<!-- Coluna do Kanban -->
<div class="kanban-column" data-state="orcamento">
  <div class="column-header">
    <h3>üìã Or√ßamento</h3>
    <span class="badge">3</span>
  </div>

  <div class="column-body" id="column-orcamento">
    <!-- Cards arrast√°veis -->
    <div class="kanban-card" data-process-id="123" draggable="true">
      <div class="card-header">
        <span class="card-id">#123</span>
        <span class="card-date">20/10/2025</span>
      </div>
      <div class="card-body">
        <h4>Pedido Jo√£o Silva</h4>
        <div class="prerequisites">
          <label>
            <input type="checkbox" checked disabled>
            Confirma√ß√£o do Cliente
          </label>
          <label>
            <input type="checkbox" disabled>
            Checagem de Estoque
          </label>
        </div>
      </div>
      <div class="card-footer">
        <button class="btn-details">Ver Detalhes</button>
      </div>
    </div>
  </div>
</div>
```

**Testes de Aceita√ß√£o:**
- [ ] Arrastar card entre colunas atualiza estado no backend
- [ ] Clicar em card abre modal com detalhes
- [ ] Marcar pr√©-requisito como cumprido
- [ ] Filtrar processos por usu√°rio/data
- [ ] Interface responsiva em mobile

**Dura√ß√£o:** 2 semanas
**Recursos:** 1 desenvolvedor fullstack

---

### Fase 3: Rules Engine (Semanas 5-6)

**Objetivo:** Checagem autom√°tica de pr√©-requisitos

**Entreg√°veis:**
1. ‚úÖ Rules Engine (`rules_engine.py`)
2. ‚úÖ Prerequisite Validators:
   - `field_check` - Verifica campos do formul√°rio
   - `system_check` - Executa scripts Python
   - `user_action` - Verifica a√ß√µes manuais
3. ‚úÖ Sistema de auto-transition
4. ‚úÖ Notifica√ß√µes (email/webhook) em transi√ß√µes
5. ‚úÖ Background job para checagem peri√≥dica (APScheduler)

**Estrutura de Arquivos:**
```
src/
‚îú‚îÄ‚îÄ workflow/
‚îÇ   ‚îú‚îÄ‚îÄ rules_engine.py          # NEW - Motor de regras
‚îÇ   ‚îú‚îÄ‚îÄ transition_validator.py  # NEW - Validador de transi√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ event_logger.py          # NEW - Logger de eventos
‚îÇ   ‚îî‚îÄ‚îÄ notifier.py              # NEW - Sistema de notifica√ß√µes
‚îî‚îÄ‚îÄ scripts/
    ‚îî‚îÄ‚îÄ workflow_checks/
        ‚îú‚îÄ‚îÄ check_estoque.py     # NEW - Exemplo de checagem
        ‚îî‚îÄ‚îÄ check_pagamento.py   # NEW - Exemplo de checagem
```

**Exemplo de Auto-Transition:**
```python
# Background job executado a cada 5 minutos
from apscheduler.schedulers.background import BackgroundScheduler

scheduler = BackgroundScheduler()

@scheduler.scheduled_job('interval', minutes=5)
def check_workflows_auto_transition():
    """Verifica todos processos ativos para auto-transition."""
    active_processes = workflow_manager.get_active_processes()

    for process in active_processes:
        if process.auto_transition_enabled:
            rules_engine.auto_transition_if_ready(process.id)

scheduler.start()
```

**Testes de Aceita√ß√£o:**
- [ ] Pr√©-requisito `field_check` funciona corretamente
- [ ] Script Python executado e resultado registrado
- [ ] Auto-transition ocorre quando pr√©-requisitos cumpridos
- [ ] Notifica√ß√£o enviada em transi√ß√£o
- [ ] Background job executa periodicamente
- [ ] 20+ testes unit√°rios passando

**Dura√ß√£o:** 2 semanas
**Recursos:** 1 desenvolvedor backend

---

### Fase 4: Integration & Polish (Semanas 7-8)

**Objetivo:** Integrar com formul√°rios existentes

**Entreg√°veis:**
1. ‚úÖ Link de formul√°rios com workflows
   - Ao criar registro no form "pedidos", auto-criar processo
   - Editar form atualiza dados do processo
2. ‚úÖ Workflow selector na cria√ß√£o de form spec
3. ‚úÖ Dashboard de workflows (vis√£o geral de todos processos)
4. ‚úÖ M√©tricas e analytics:
   - Tempo m√©dio por estado
   - Taxa de convers√£o
   - Gargalos (estados com mais processos)
5. ‚úÖ Documenta√ß√£o completa (`docs/workflow_system.md`)

**Exemplo de Integra√ß√£o com Formul√°rio:**
```json
// src/specs/pedidos.json (modificado)
{
  "title": "Pedidos",
  "icon": "fa-shopping-cart",
  "workflow": "pedidos",  // <-- NEW: Associa workflow
  "fields": [
    {"name": "cliente", "type": "text", "required": true},
    {"name": "produto", "type": "text", "required": true},
    {"name": "quantidade", "type": "number", "required": true},
    {"name": "forma_pagamento", "type": "select", "options": [...]},
    {"name": "forma_entrega", "type": "select", "options": [...]}
  ]
}
```

**Dashboard de M√©tricas:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  Dashboard de Workflows                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                              ‚îÇ
‚îÇ  üìä M√©tricas Gerais                                          ‚îÇ
‚îÇ  ‚Ä¢ Total de processos ativos: 47                            ‚îÇ
‚îÇ  ‚Ä¢ Processos conclu√≠dos (m√™s): 123                          ‚îÇ
‚îÇ  ‚Ä¢ Taxa de convers√£o: 87%                                   ‚îÇ
‚îÇ  ‚Ä¢ Tempo m√©dio de conclus√£o: 4.2 dias                       ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚è±Ô∏è Tempo M√©dio por Estado                                   ‚îÇ
‚îÇ  ‚Ä¢ Or√ßamento: 1.2 dias                                       ‚îÇ
‚îÇ  ‚Ä¢ Em Prepara√ß√£o: 0.8 dias                                   ‚îÇ
‚îÇ  ‚Ä¢ Aguardando Pagamento: 1.5 dias                           ‚îÇ
‚îÇ  ‚Ä¢ Entrega: 0.7 dias                                         ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  üöß Gargalos Identificados                                   ‚îÇ
‚îÇ  ‚Ä¢ Aguardando Pagamento: 18 processos (acima da m√©dia)      ‚îÇ
‚îÇ  ‚Ä¢ Sugest√£o: Revisar pol√≠tica de pagamento                  ‚îÇ
‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Testes de Aceita√ß√£o:**
- [ ] Criar pedido cria processo automaticamente
- [ ] Editar pedido atualiza dados do processo
- [ ] Dashboard mostra m√©tricas corretas
- [ ] Exportar relat√≥rio de processos (CSV/PDF)
- [ ] 50+ testes unit√°rios passando (total acumulado)

**Dura√ß√£o:** 2 semanas
**Recursos:** 1 desenvolvedor fullstack

---

### Fase 5: AI Integration (Semanas 9-12) - OPCIONAL

**Objetivo:** Agentes de IA para automa√ß√£o

**Entreg√°veis:**
1. ‚úÖ AI Workflow Agent
2. ‚úÖ Integra√ß√£o com LLM (OpenAI ou Anthropic)
3. ‚úÖ An√°lise inteligente de processos
4. ‚úÖ Sugest√µes autom√°ticas de a√ß√£o
5. ‚úÖ Auto-completion de campos baseado em contexto

**Use Cases de IA:**
- IA analisa pedido e verifica se dados do cliente est√£o completos
- IA sugere forma de entrega baseado em hist√≥rico do cliente
- IA detecta anomalias (pre√ßo muito baixo, quantidade suspeita)
- IA preenche automaticamente campos com base em pedidos anteriores

**Exemplo de An√°lise Inteligente:**
```python
# IA analisa processo e sugere a√ß√µes
analysis = ai_agent.analyze_process(process_id=123)

# Resultado:
{
    "prerequisites_met": false,
    "issues": [
        "Campo 'endere√ßo de entrega' vazio",
        "Telefone do cliente est√° desatualizado"
    ],
    "recommendation": "Solicitar atualiza√ß√£o de dados do cliente antes de prosseguir",
    "confidence": 0.92,
    "suggested_actions": [
        {
            "action": "send_email",
            "to": "cliente@example.com",
            "template": "solicitar_atualizacao_dados"
        }
    ]
}
```

**Testes de Aceita√ß√£o:**
- [ ] IA detecta campos incompletos
- [ ] IA sugere a√ß√µes corretamente
- [ ] IA detecta anomalias com precis√£o >85%
- [ ] Auto-completion funciona para campos comuns
- [ ] Custo de API LLM dentro do budget ($100/m√™s)

**Dura√ß√£o:** 4 semanas
**Recursos:** 1 desenvolvedor backend + 1 especialista em IA
**Custo Adicional:** API LLM (~$100-200/m√™s)

---

## 5. Estimativa de Esfor√ßo

| Fase | Dura√ß√£o | Complexidade | Recursos | Custo |
|------|---------|--------------|----------|-------|
| **Fase 1: Foundation** | 2 semanas | M√©dia | 1 dev backend | - |
| **Fase 2: Kanban UI** | 2 semanas | Alta | 1 dev fullstack | - |
| **Fase 3: Rules Engine** | 2 semanas | Alta | 1 dev backend | - |
| **Fase 4: Integration** | 2 semanas | M√©dia | 1 dev fullstack | - |
| **Fase 5: AI (opcional)** | 4 semanas | Muito Alta | 1 dev + 1 AI specialist | API LLM |
| **TOTAL (sem IA)** | **8 semanas** | - | - | - |
| **TOTAL (com IA)** | **12 semanas** | - | - | $800-1600 |

### Marcos (Milestones)

- **Semana 2:** MVP funcional (transi√ß√µes manuais) ‚úÖ
- **Semana 4:** Interface Kanban operacional ‚úÖ
- **Semana 6:** Automa√ß√£o de regras completa ‚úÖ
- **Semana 8:** Sistema integrado e polished ‚úÖ
- **Semana 12:** IA integrada (opcional) ‚úÖ

### MVP (Minimal Viable Product)

**Fases 1-3 = 6 semanas**

O MVP entrega:
- ‚úÖ Workflows definidos via JSON
- ‚úÖ Interface Kanban drag & drop
- ‚úÖ Transi√ß√µes manuais e autom√°ticas
- ‚úÖ Regras de pr√©-requisitos
- ‚úÖ Hist√≥rico completo de transi√ß√µes

---

## 6. Riscos e Mitiga√ß√£o

| Risco | Probabilidade | Impacto | Mitiga√ß√£o |
|-------|---------------|---------|-----------|
| **Complexidade de state machine** | M√©dia | Alto | Usar biblioteca `python-statemachine` j√° consolidada |
| **Performance com muitos processos** | Baixa | M√©dio | Indexa√ß√£o adequada no DB, pagina√ß√£o na UI, cache |
| **Drag & drop n√£o funcionar em mobile** | M√©dia | Baixo | Fallback para bot√µes de a√ß√£o tradicionais |
| **Integra√ß√£o quebrando forms existentes** | Baixa | Alto | Testes de regress√£o extensivos, feature flags |
| **AI agents aumentando custos** | Alta | M√©dio | Opcional, com controle de budget e rate limiting |

### Estrat√©gias de Mitiga√ß√£o Detalhadas

#### 1. State Machine Complexity
**Problema:** Implementar state machine do zero √© complexo e propenso a bugs.

**Solu√ß√£o:**
- Usar biblioteca `python-statemachine` (4.5k stars no GitHub)
- Documenta√ß√£o clara de estados e transi√ß√µes
- Testes unit√°rios para todas transi√ß√µes poss√≠veis

```python
from statemachine import StateMachine, State

class PedidoWorkflow(StateMachine):
    orcamento = State('Or√ßamento', initial=True)
    em_preparacao = State('Em Prepara√ß√£o')
    aguardando_pagamento = State('Aguardando Pagamento')
    entrega = State('Entrega')
    concluido = State('Conclu√≠do', final=True)
    cancelado = State('Cancelado', final=True)

    aprovar = orcamento.to(em_preparacao)
    confirmar_pagamento = em_preparacao.to(aguardando_pagamento)
    # ...
```

#### 2. Performance
**Problema:** Muitos processos podem degradar performance da UI.

**Solu√ß√£o:**
- Pagina√ß√£o no backend (20 processos por p√°gina)
- Lazy loading de cards no Kanban
- Indexa√ß√£o em `workflow_processes.current_state`
- Cache de queries frequentes (Redis se necess√°rio)

#### 3. Mobile UX
**Problema:** Drag & drop pode n√£o funcionar bem em touch screens.

**Solu√ß√£o:**
- Detectar dispositivo m√≥vel
- Exibir bot√µes de a√ß√£o ao inv√©s de drag & drop
- Interface adaptativa responsiva

#### 4. Breaking Changes
**Problema:** Integra√ß√£o pode quebrar formul√°rios existentes.

**Solu√ß√£o:**
- Feature flag: `WORKFLOW_ENABLED=false` por padr√£o
- Testes de regress√£o: todos os 41 testes atuais devem passar
- Workflows s√£o opt-in via config JSON

#### 5. AI Costs
**Problema:** Custos de API LLM podem escalar rapidamente.

**Solu√ß√£o:**
- Limite de requests por dia
- Cache de an√°lises repetidas
- Usar modelos menores quando poss√≠vel
- Monitoramento de custos com alertas

---

## 7. Compatibilidade e Backward Compatibility

### ‚úÖ N√£o quebrar√° funcionalidade existente

| Aspecto | Impacto | Garantia |
|---------|---------|----------|
| **Workflows s√£o opcionais** | Zero | Sistema opt-in por formul√°rio via configura√ß√£o JSON |
| **Forms sem workflow continuam funcionando** | Zero | Nenhuma modifica√ß√£o em formul√°rios n√£o associados |
| **Sistema de persist√™ncia** | Zero | Usa mesmo BaseRepository j√° implementado |
| **Templates Jinja2** | Zero | Templates existentes n√£o s√£o modificados, apenas adicionados |
| **Testes existentes** | Zero | Todos os 41 testes atuais devem continuar passando |

### Migration Path (Caminho de Migra√ß√£o)

**Etapas para ado√ß√£o:**

1. **Deploy v4.0 com workflow engine**
   - Sistema instalado mas inativo por padr√£o
   - Flag `WORKFLOW_ENABLED=false` em config

2. **Criar workflow spec para forms desejados**
   - Exemplo: `pedidos.json` ‚Üí `pedidos_workflow.json`
   - Associar form ao workflow no spec JSON

3. **Migrar processos existentes (se houver)**
   - Script de migra√ß√£o para criar processos hist√≥ricos
   - Opcional: importar dados de sistemas antigos

4. **Ativar workflow por form**
   - Adicionar `"workflow": "pedidos"` no spec do form
   - Criar banco de dados (migrations autom√°ticas)

5. **Monitorar e ajustar**
   - Dashboard de m√©tricas
   - Ajustar pr√©-requisitos conforme feedback
   - Iterar baseado em uso real

### Exemplo de Ativa√ß√£o Gradual

```json
// Fase 1: Apenas "pedidos" usa workflow
{
  "pedidos": {"workflow": "pedidos"},
  "contatos": {},  // Sem workflow
  "produtos": {}   // Sem workflow
}

// Fase 2: Adicionar "vendas"
{
  "pedidos": {"workflow": "pedidos"},
  "vendas": {"workflow": "vendas"},
  "contatos": {},
  "produtos": {}
}

// Fase 3: Expandir para outros forms
// ...
```

---

## 8. Benef√≠cios

### Para o Projeto VibeCForms

| Benef√≠cio | Descri√ß√£o |
|-----------|-----------|
| **Evolu√ß√£o arquitetural** | De CRUD simples ‚Üí Sistema de Gest√£o de Processos de Neg√≥cio completo |
| **Demonstra√ß√£o de escalabilidade** | Prova que a arquitetura suporta funcionalidades complexas |
| **Case de Vibe Coding** | Mais um exemplo bem-sucedido de desenvolvimento assistido por IA |
| **Diferencial competitivo** | Poucos sistemas de formul√°rios din√¢micos incluem workflow engine nativo |
| **Open Source Impact** | Atrai mais contribuidores e usu√°rios para o projeto |

### Para Usu√°rios Finais

| Benef√≠cio | Impacto |
|-----------|---------|
| **Visibilidade total** | Kanban visual mostra status de todos processos em tempo real |
| **Redu√ß√£o de trabalho manual** | Automa√ß√£o de checagens reduz erros em 60-80% |
| **Auditoria completa** | Hist√≥rico detalhado de quem fez o qu√™ e quando (compliance) |
| **Qualidade de dados** | Pr√©-requisitos obrigat√≥rios garantem 100% de completude |
| **Colabora√ß√£o melhorada** | M√∫ltiplos usu√°rios trabalham simultaneamente sem conflitos |
| **Notifica√ß√µes proativas** | Alertas autom√°ticos sobre mudan√ßas de estado |

### Para Desenvolvedores

| Benef√≠cio | Descri√ß√£o |
|-----------|-----------|
| **Padr√µes reutiliz√°veis** | Workflow specs podem ser duplicados e adaptados facilmente |
| **Configura√ß√£o declarativa** | Specs JSON s√£o f√°ceis de criar e manter (sem c√≥digo) |
| **Extensibilidade via scripts** | Scripts Python customizados para regras espec√≠ficas de neg√≥cio |
| **Preparado para futuro** | Arquitetura permite adicionar IA (Fase 5) quando necess√°rio |
| **Documenta√ß√£o autom√°tica** | Workflow specs servem como documenta√ß√£o viva de processos |
| **Testabilidade** | State machines facilitam testes unit√°rios de transi√ß√µes |

### M√©tricas de Sucesso Esperadas

**Ap√≥s 3 meses de uso:**
- ‚úÖ 80% dos processos fluem sem interven√ß√£o manual
- ‚úÖ Tempo m√©dio de conclus√£o reduzido em 30-40%
- ‚úÖ Taxa de erros de dados reduzida em 60-70%
- ‚úÖ Satisfa√ß√£o de usu√°rios: 8.5/10 ou superior
- ‚úÖ 100% de processos audit√°veis

---

## 9. Recomenda√ß√£o Final

### üü¢ RECOMENDO PROSSEGUIR COM A IMPLEMENTA√á√ÉO

Seguindo o plano de **4 fases** (sem IA inicialmente), com **MVP entregue em 6 semanas**.

### Raz√µes para Aprova√ß√£o

| # | Raz√£o | Justificativa |
|---|-------|---------------|
| ‚úÖ | **Arquitetura suporta bem** | Persistence Layer e Repository Pattern j√° implementados |
| ‚úÖ | **Alinhamento com filosofia** | JSON specs, AI-assisted, Vibe Coding |
| ‚úÖ | **MVP vi√°vel** | 6 semanas para funcionalidade completa |
| ‚úÖ | **Riscos gerenci√°veis** | Todos os riscos t√™m mitiga√ß√µes claras |
| ‚úÖ | **Benef√≠cios tang√≠veis** | Medidas mensur√°veis para todos stakeholders |
| ‚úÖ | **Zero breaking changes** | Totalmente backward compatible |

### Pr√≥ximos Passos Recomendados

1. **Aprovar arquitetura proposta** e plano de implementa√ß√£o ‚úÖ
2. **Criar branch Git** `feature/workflow-engine`
3. **Implementar Fase 1** (Foundation) - 2 semanas
4. **Demonstrar MVP** funcional ao stakeholder para valida√ß√£o
5. **Iterar baseado em feedback** e iniciar Fase 2
6. **Documentar processo** em `docs/prompts.md` (Vibe Coding)

### Crit√©rios de Sucesso

**Para considerar o projeto bem-sucedido:**
- [ ] Todos os 41 testes atuais continuam passando
- [ ] 50+ novos testes implementados (workflow system)
- [ ] Documenta√ß√£o completa em `/docs/workflow_system.md`
- [ ] Exemplo funcional (pedidos) demonstr√°vel
- [ ] Performance: <200ms para transi√ß√µes
- [ ] Zero regress√µes em funcionalidades existentes

### Alternativas Consideradas

**Por que n√£o usar ferramenta externa?**
- ‚ùå **Camunda, Airflow, n8n:** Complexidade excessiva, overhead de infraestrutura
- ‚ùå **Zapier, Make:** N√£o open-source, custos recorrentes, limita√ß√µes
- ‚úÖ **Solu√ß√£o nativa:** Integra√ß√£o perfeita, controle total, sem custos adicionais

---

## 10. Tecnologias Recomendadas

### Backend

| Tecnologia | Vers√£o | Uso | Justificativa |
|------------|--------|-----|---------------|
| **python-statemachine** | 2.1+ | State machine implementation | 4.5k stars, bem mantida, type-safe |
| **APScheduler** | 3.10+ | Background jobs | Leve, n√£o requer Redis/Celery |
| **pydantic** | 2.5+ | Valida√ß√£o de schemas JSON | Type-safe, j√° usado em projetos similares |
| **SQLAlchemy** | 2.0+ | ORM (opcional) | Se queries complexas forem necess√°rias |

**Instala√ß√£o:**
```bash
uv pip install python-statemachine apscheduler pydantic
```

### Frontend

| Tecnologia | Vers√£o | Uso | Justificativa |
|------------|--------|-----|---------------|
| **SortableJS** | 1.15+ | Drag & drop | 28k stars, lightweight (5kb gzip), touch-friendly |
| **Alpine.js** | 3.13+ | Reatividade | 27k stars, "jQuery do futuro", 15kb |
| **Tailwind CSS** | 3.4+ | Styling | Utility-first, responsivo, consistente |
| **Chart.js** | 4.4+ | Visualiza√ß√£o de m√©tricas | 63k stars, simples e poderoso |

**CDN (para desenvolvimento r√°pido):**
```html
<!-- SortableJS -->
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

<!-- Alpine.js -->
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
```

### Testing

| Tecnologia | Vers√£o | Uso | Justificativa |
|------------|--------|-----|---------------|
| **pytest** | 7.4+ | Framework de testes | J√° usado no projeto |
| **pytest-mock** | 3.12+ | Mocking | Simplifica mocking de depend√™ncias |
| **playwright** | 1.40+ | Testes E2E | Testa UI Kanban, cross-browser |
| **pytest-cov** | 4.1+ | Cobertura de testes | Manter 90%+ coverage |

**Instala√ß√£o:**
```bash
uv pip install pytest pytest-mock pytest-cov playwright
python -m playwright install  # Instala browsers
```

### AI Integration (Fase 5 - Opcional)

| Tecnologia | Vers√£o | Uso | Custo Estimado |
|------------|--------|-----|----------------|
| **langchain** | 0.1+ | Framework LLM | Gr√°tis (open source) |
| **openai** | 1.6+ | API OpenAI GPT-4 | $100-200/m√™s |
| **anthropic** | 0.8+ | API Claude 3 | $100-200/m√™s |
| **langsmith** | 0.0.7+ | Observabilidade | Gr√°tis (tier gratuito) |

**Instala√ß√£o (quando necess√°rio):**
```bash
uv pip install langchain openai anthropic langsmith
```

**Custos de API (estimativa):**
- **GPT-4-turbo:** $0.01/1k tokens input, $0.03/1k tokens output
- **Claude 3 Sonnet:** $0.003/1k tokens input, $0.015/1k tokens output
- **Estimativa:** ~$100-200/m√™s para 10k processos analisados

### Infraestrutura (Opcional)

| Tecnologia | Uso | Quando usar |
|------------|-----|-------------|
| **Redis** | Cache de queries | Se >10k processos ativos |
| **Celery** | Queue de tarefas | Se APScheduler n√£o for suficiente |
| **Docker** | Containeriza√ß√£o | Para deploy em produ√ß√£o |
| **Nginx** | Reverse proxy | Deploy em produ√ß√£o |

---

## Conclus√£o

A implementa√ß√£o do **Sistema de Regras de Neg√≥cio tipo Kanban** para o VibeCForms representa uma evolu√ß√£o natural e estrat√©gica do projeto. A an√°lise t√©cnica demonstra que:

| Aspecto | Avalia√ß√£o |
|---------|-----------|
| **Viabilidade T√©cnica** | üü¢ ALTA - Arquitetura atual fornece base s√≥lida |
| **Complexidade** | üü° GERENCI√ÅVEL - 8 semanas com equipe experiente |
| **Riscos** | üü° BAIXOS A M√âDIOS - Todos com mitiga√ß√µes claras |
| **ROI** | üü¢ POSITIVO - Benef√≠cios tang√≠veis mensur√°veis |
| **Compatibilidade** | üü¢ 100% - Zero breaking changes, opt-in |

O exemplo de uso proposto (fluxo de **Pedidos** com estados Or√ßamento ‚Üí Em Prepara√ß√£o ‚Üí Aguardando Pagamento ‚Üí Entrega ‚Üí Conclu√≠do) demonstra claramente a aplicabilidade pr√°tica do sistema e seu alinhamento com necessidades reais de neg√≥cio.

A implementa√ß√£o em fases permite **valida√ß√£o incremental** e ajustes baseados em feedback, minimizando riscos e maximizando chances de sucesso.

---

### üü¢ STATUS: APROVADO PARA IMPLEMENTA√á√ÉO

**Recomenda-se iniciar com Fases 1-3 (MVP em 6 semanas)**
**e avaliar expans√£o com IA (Fase 5) ap√≥s valida√ß√£o inicial.**

---

*Documento gerado em 20/10/2025*
*An√°lise conduzida com assist√™ncia de IA (Claude Code)*
*Projeto VibeCForms - Open Source - Vibe Coding*

---

## Refer√™ncias

- **VibeCForms GitHub:** https://github.com/rodrigo-user/VibeCForms
- **python-statemachine:** https://github.com/fgmacedo/python-statemachine
- **SortableJS:** https://github.com/SortableJS/Sortable
- **Alpine.js:** https://alpinejs.dev/
- **APScheduler:** https://apscheduler.readthedocs.io/
- **LangChain:** https://python.langchain.com/

---

## Hist√≥rico de Vers√µes

| Vers√£o | Data | Descri√ß√£o | Autor |
|--------|------|-----------|-------|
| 1.0 | 20/10/2025 | Vers√£o inicial da an√°lise de viabilidade | Claude Code + Rodrigo |

---

## Anexos

### Anexo A: Exemplo Completo de Workflow Spec

Ver arquivo: `src/specs/workflows/pedidos_workflow.json`

### Anexo B: Schema SQL Completo

Ver arquivo: `src/workflow/migrations/001_create_workflow_tables.sql`

### Anexo C: Exemplo de Script de Checagem

Ver arquivo: `scripts/workflow_checks/check_estoque.py`

### Anexo D: Mockup de Interface Kanban

Ver arquivo: `docs/mockups/kanban_board.png`

---

**FIM DO DOCUMENTO**
